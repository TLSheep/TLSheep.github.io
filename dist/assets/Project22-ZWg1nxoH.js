var A=Object.defineProperty;var F=(d,a,c)=>a in d?A(d,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[a]=c;var x=(d,a,c)=>(F(d,typeof a!="symbol"?a+"":a,c),c);import{_ as G,r as Y,d as J,c as N,b as k,o as U}from"./index-ry5PV9Iv.js";const R=5,f=20,V={__name:"Project22",setup(d){let a=0;const c={red:180,bule:180,green:180},M={x:400,y:100},g=Y(null),m=Y(null),j=window.innerHeight*devicePixelRatio,I=window.innerWidth*devicePixelRatio,b=Y({x:0,y:0});let D="imgs/sgmm.png",l=null,w=null,y=0;J(async()=>{E();const e=await T(D);w=new L(e),w.draw()});function E(){m.value.height=window.innerHeight*devicePixelRatio,m.value.width=window.innerWidth*devicePixelRatio,l=m.value.getContext("2d")}async function T(e){let t=await q(e);console.log(t);let n=[];l.drawImage(t,0,0,t.width,t.height);const r=l.getImageData(0,0,t.width,t.height).data;for(let o=0;o<t.height;o++)for(let i=0;i<t.width;i++){let u=B(i,o,t.width);const v=r[u],X=r[u+1],W=r[u+2];v<c.red&&X<c.green&&W<c.bule&&n.push(new S(M.x+R*i,M.y+R*o,1.5,"#C2C2C2"))}return n}function q(e){return new Promise((t,n)=>{const s=new Image;s.src=e,s.onload=function(){t(s)},s.onerror=function(r){n(r)}})}function C(e){y&&Date.now()-y<f||(y=Date.now(),b.value={x:e.clientX-g.value.offsetLeft,y:e.clientY-g.value.offsetTop})}function P(e,t){return Math.atan(Math.abs((e.curretntY-t.y)/(e.curretntX-t.x)))}function _(e,t){return Math.floor(Math.sqrt(Math.pow(e.curretntX-t.x,2)+Math.pow(e.curretntY-t.y,2)))}function B(e,t,n){return(t*n+e)*4}function h(e,t,n=200){e.timer++;const s={x:e.destinationX,y:e.destinationY};if(_(e,{x:e.destinationX,y:e.destinationY})<=1){e.curretntX=e.destinationX,e.curretntY=e.destinationY;return}const r=P(e,s),o=_(e,s)/t,i=Math.cos(r)*(s.x-e.curretntX<0?-1:1)*o,u=Math.sin(r)*(s.y-e.curretntY<0?-1:1)*o;a++,e.curretntX+=i*2,e.curretntY+=u*2,setTimeout(()=>h(e,t,n),n)}class L{constructor(t){x(this,"points");x(this,"mindistance_30",20);x(this,"mindistance_50",50);this.points=t,console.log(this.points)}draw(){requestAnimationFrame(()=>{this.draw()}),l.clearRect(0,0,I,j),console.log(a),this.points.forEach(t=>{{const n=b.value,s=P(t,n);let r=_(t,n);const o=_(t,t),i=Math.cos(s)*(t.curretntX-n.x<0?-1:1),u=Math.sin(s)*(t.curretntY-n.y<0?-1:1);switch(this.get_type(r)){case"quick_out":t.curretntX+=Math.floor((this.mindistance_30-r)*i),t.curretntY+=Math.floor((this.mindistance_30-r)*u),r=30;case"slow_out":t.destinationX=t.curretntX+Math.floor((this.mindistance_50-r)*i),t.destinationY=t.curretntY+Math.floor((this.mindistance_50-r)*u),h(t,r,f);break;case"around3":if((t.curretntX-t.x)*(t.curretntX-n.x)>=0&&(t.curretntY-t.y)*(t.curretntY-n.y)>=0){let v=t.curretntX-t.x>0?.9:-.9,X=t.curretntY-t.y>0?.9:-.9;t.destinationX=t.curretntX+2*Math.abs(u)*v,t.destinationY=t.curretntY+2*Math.abs(i)*X,h(t,.5,f);break}case"normal":t.destinationX=t.x,t.destinationY=t.y,h(t,50,f);break;case"back":o>=1?(t.destinationX=t.x,t.destinationY=t.y,h(t,100,f)):(t.curretntX=t.x,t.curretntY=t.y);break}}t.draw()})}get_type(t){if(t<1e3){if(t<this.mindistance_30)return"quick_out";if(t>=this.mindistance_30&&t<this.mindistance_50)return"slow_out";if(t>=this.mindistance_50&&t<this.mindistance_50+5)return"around";if(t>this.mindistance_50+5)return"normal"}else if(t>1e3)return"back"}reset_point(){this.points.forEach(t=>{t.curretntX=t.x,t.curretntY=t.y})}}class S{constructor(t,n,s="2",r="#000"){this.x=t*devicePixelRatio,this.y=n*devicePixelRatio,this.curretntX=this.x,this.curretntY=this.y,this.destinationX=this.x,this.destinationY=this.y,this.radius=s*devicePixelRatio,this.color=r,this.lastDrawTime=Date.now(),this.mouseLastMoveTime=0,this.timer=0}draw(){l.beginPath(),l.arc(this.curretntX,this.curretntY,this.radius,0,Math.PI*2),l.fillStyle=this.color,l.fill()}}function H(){w.reset_point()}return(e,t)=>(U(),N("div",{class:"container",ref_key:"containerRef",ref:g},[k("button",{class:"btn",onClick:H},"RESET"),k("canvas",{id:"canvasJq",class:"canvas",ref_key:"canvasRef",ref:m,onMousemove:C},null,544)],512))}},O=G(V,[["__scopeId","data-v-59d4c16d"]]);export{O as default};
