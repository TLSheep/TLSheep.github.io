var A=Object.defineProperty;var F=(d,i,o)=>i in d?A(d,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[i]=o;var x=(d,i,o)=>(F(d,typeof i!="symbol"?i+"":i,o),o);import{_ as G,r as Y,d as J,c as N,b as k,o as U}from"./index-zqfHwrb3.js";const R=5,f=20,V={__name:"Project22",setup(d){let i=0;const o={red:180,bule:180,green:180},M={x:400,y:300},g=Y(null),m=Y(null),j=window.innerHeight*devicePixelRatio,I=window.innerWidth*devicePixelRatio,b=Y({x:0,y:0});let D="/imgs/sgmm.png",l=null,w=null,y=0;J(async()=>{E();const e=await T(D);w=new L(e),w.draw()});function E(){m.value.height=window.innerHeight*devicePixelRatio,m.value.width=window.innerWidth*devicePixelRatio,l=m.value.getContext("2d")}async function T(e){let t=await q(e);console.log(t);let r=[];l.drawImage(t,0,0,t.width,t.height);const n=l.getImageData(0,0,t.width,t.height).data;for(let u=0;u<t.height;u++)for(let a=0;a<t.width;a++){let c=B(a,u,t.width);const v=n[c],X=n[c+1],W=n[c+2];v<o.red&&X<o.green&&W<o.bule&&r.push(new S(M.x+R*a,M.y+R*u,1.5,"#C2C2C2"))}return r}function q(e){return new Promise((t,r)=>{const s=new Image;s.src=e,s.onload=function(){t(s)},s.onerror=function(n){r(n)}})}function C(e){y&&Date.now()-y<f||(y=Date.now(),b.value={x:e.clientX-g.value.offsetLeft,y:e.clientY-g.value.offsetTop})}function P(e,t){return Math.atan(Math.abs((e.curretntY-t.y)/(e.curretntX-t.x)))}function _(e,t){return Math.floor(Math.sqrt(Math.pow(e.curretntX-t.x,2)+Math.pow(e.curretntY-t.y,2)))}function B(e,t,r){return(t*r+e)*4}function h(e,t,r=200){e.timer++;const s={x:e.destinationX,y:e.destinationY};if(_(e,{x:e.destinationX,y:e.destinationY})<=2){e.curretntX=e.destinationX,e.curretntY=e.destinationY;return}const n=P(e,s),u=_(e,s)/t,a=Math.cos(n)*(s.x-e.curretntX<0?-1:1)*u,c=Math.sin(n)*(s.y-e.curretntY<0?-1:1)*u;i++,e.curretntX+=a*2,e.curretntY+=c*2,setTimeout(()=>h(e,t,r),r)}class L{constructor(t){x(this,"points");x(this,"mindistance_30",20);x(this,"mindistance_50",50);this.points=t,console.log(this.points)}draw(){requestAnimationFrame(()=>{this.draw()}),l.clearRect(0,0,I,j),console.log(i),this.points.forEach(t=>{{const r=b.value,s=P(t,r);let n=_(t,r);const u=_(t,t),a=Math.cos(s)*(t.curretntX-r.x<0?-1:1),c=Math.sin(s)*(t.curretntY-r.y<0?-1:1);switch(this.get_type(n)){case"quick_out":t.curretntX+=Math.floor((this.mindistance_30-n)*a),t.curretntY+=Math.floor((this.mindistance_30-n)*c),n=30;case"slow_out":t.destinationX=t.curretntX+Math.floor((this.mindistance_50-n)*a),t.destinationY=t.curretntY+Math.floor((this.mindistance_50-n)*c),h(t,n,f);break;case"around3":if((t.curretntX-t.x)*(t.curretntX-r.x)>=0&&(t.curretntY-t.y)*(t.curretntY-r.y)>=0){let v=t.curretntX-t.x>0?.9:-.9,X=t.curretntY-t.y>0?.9:-.9;t.destinationX=t.curretntX+2*Math.abs(c)*v,t.destinationY=t.curretntY+2*Math.abs(a)*X,h(t,.5,f);break}case"normal":t.destinationX=t.x+a*(15-n/500),t.destinationY=t.y+c*(15-n/500),h(t,50,f);break;case"back":u>=2?(t.destinationX=t.x,t.destinationY=t.y,h(t,100,f)):(t.curretntX=t.x,t.curretntY=t.y);break}}t.draw()})}get_type(t){if(t<1e3){if(t<this.mindistance_30)return"quick_out";if(t>=this.mindistance_30&&t<this.mindistance_50)return"slow_out";if(t>=this.mindistance_50&&t<this.mindistance_50+5)return"around";if(t>this.mindistance_50+5)return"normal"}else if(t>1e3)return"back"}reset_point(){this.points.forEach(t=>{t.curretntX=t.x,t.curretntY=t.y})}}class S{constructor(t,r,s="2",n="#000"){this.x=t*devicePixelRatio,this.y=r*devicePixelRatio,this.curretntX=this.x,this.curretntY=this.y,this.destinationX=this.x,this.destinationY=this.y,this.radius=s*devicePixelRatio,this.color=n,this.lastDrawTime=Date.now(),this.mouseLastMoveTime=0,this.timer=0}draw(){l.beginPath(),l.arc(this.curretntX,this.curretntY,this.radius,0,Math.PI*2),l.fillStyle=this.color,l.fill()}}function H(){w.reset_point()}return(e,t)=>(U(),N("div",{class:"container",ref_key:"containerRef",ref:g},[k("button",{class:"btn",onClick:H},"RESET"),k("canvas",{id:"canvasJq",class:"canvas",ref_key:"canvasRef",ref:m,onMousemove:C},null,544)],512))}},O=G(V,[["__scopeId","data-v-91e6b424"]]);export{O as default};
